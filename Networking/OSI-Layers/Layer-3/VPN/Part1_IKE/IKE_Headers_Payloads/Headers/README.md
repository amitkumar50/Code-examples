## Headers

- **1. IKE HEADER**
```c
    |- Initiator SPI
    |- Responder SPI
    |- Next Payload: 0:None, 1:SA, 2:Proposal(P), 3:Transform (T), 4:Key Exchange (KE), 5:Identification (ID), 6:Certificate (CERT), 7:Certificate Request (CR), 8:Hash (HASH), 9:Signature(SIG), 10: Nonce(NONCE), 11:Notification(N), 12:Delete(D), 13:Vendor-id(VID), 14-227:Reserved, 128-255: Private use
    |- Version: 1.0 or 2.0
    |- Exchange Type: Type of exchange. 0:NONE, 1:Base, 2:Identity Protection, 3:Authentication Only, 4:Aggressive, 5:Informational, 6-31:ISAKMP Future Use, 32-239:DOI Specific Use, 240-255:Private Use
    |- Flags: Options set for ISAKMP exchange.    
        |- Bit-1:Encryption. All payloads following the header are encrypted using the encryption algorithm identified in the ISAKMP SA. If E(ncryption Bit) is not set (0), the payloads are not encrypted.
        |- Bit-2:Commit. It is used to ensure that encrypted material is not received prior to completion of the SA establishment.
        |- Bit-3:Authentication Only. 
    |- Message ID(4 byte): Used to identify protocol state during Phase 2 negotiations. This value is randomly generated by the initiator of the Phase 2 negotiation.
    |- Length(4 byte): Length of total message (header + payloads).  Encryption can expand the size of an ISAKMP message.
```

- **2. GENERIC PAYLOAD HEADER**
```c
    |- Next Payload(1 byte): Identifies the payload type of next payload in message. If the current payload is the last in the message, then this field will be 0.  This field provides the "chaining" capability.
    |- Reserved(1 byte): Unused. Set to 0.
    |- Payload Length(2 byte): Length of current payload, including the generic payload header.
```
