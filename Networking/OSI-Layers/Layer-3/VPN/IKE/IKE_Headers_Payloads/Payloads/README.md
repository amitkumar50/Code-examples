## IKE Payloads
- **1. SA Payload**
```c
{{Proposal-payload-1 {Tranform-payload-1a, Tranform-payload-1b}} {Proposal-payload-2 {Tranform-payload-2a, Tranform-payload-2b}}}
    |- DOI(4 byte): Identifies DOI under which this negotiation is taking place. DOI=0 during Phase-1 specifies a Generic ISAKMP SA which can be used for any protocol during the Phase 2 exchange. DOI=1 is for IPSec. 
    |- Situation(variable length):  (Identity Only:1, Secrecy:0, Integrity:0
```    

- **2. PROPOSAL PAYLOAD:** Consists of security mechanisms/transforms, to be used to secure the communications channel. 
```c
    |- Proposal no(1 byte): Proposal number for current payload.
    |- Protocol-ID(1 byte): protocol identifier for the current negotiation.  Examples might include IPSEC ESP, IPSEC AH, OSPF, TLS, etc.
    |- SPI-size(1 byte): how long SPI would be. if SPI-size=0, no SPI would be present.
    |- Number-of-transforms(1 byte): Specifies the number of transforms for the Proposal.  Each of these is contained in a Transform payload.
    |- SPI(variable): The sending entity's SPI.
```

- **3. TRANSFORM PAYLOAD:** Contains information used during SA negotiation.
```c
    |- Transform-no(1 byte): Identifies the Transform number for the current payload. If there is more than one transform proposed for a specific protocol within the Proposal payload, then each Transform payload has a unique Transform number.
    |- Transform-ID(1 byte): identifier the protocol within the current proposal.
    |- Reserved(2 bytes): 0
    |- SA-Attributes(variable length): SA attributes defined in key:value pair format.
```

- **4. VENDOR ID PAYLOAD** 
  - Contains a vendor defined constant. The constant is used by vendors to identify and recognize remote instances of their implementations. Always sent during Phase-1. 
```c
    |- Vendor-id(variable): This is can hash of string(may be product name+version_no)
```

- **5. KEY EXCHANGE PAYLOAD:** Supports different Key exchange mechanisms. Eg: Oakley, Diffie-Hellman, Enhanced Diffie-Hellman, RSA based.
```c
    |- Key-exchange-data(variable): Data required to generate session key.  
        The interpretation of this data is specified by DOI and associated Key Exchange algorithm.     
        [For Example for DH-Key-exchange: This will be public key of Initiator]
```

- **6. NONCE PAYLOAD**
```
    |- Nonce-data(variable): Contains random data generated by sender.
```

- **7. IDENTIFICATION PAYLOAD** Has DOI part for used for exchange of identification data. Determines identities of communicating peers.
```c
    |- ID Type(1 byte): Specifies the type of Identification being used.
    |- DOI Specific ID Data (3 bytes): Contains DOI specific Identification data. If unused, then this field MUST be set to 0.
    |- Identification data(variable): Contains identity information.
```

- **8. HASH PAYLOAD:** Contains data generated by hash function. This payload may be used to verify the integrity of the data in an ISAKMP message or for authentication of the negotiating entities
```c
    |- Hash data(variable): Data that results from applying the hash routine to the ISAKMP message
```
